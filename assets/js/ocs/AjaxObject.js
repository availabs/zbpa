function AjaxObject(G,C){var D=this;var F=false;this.runAfterProcessingRequest=function(){};this.resetAfterProcessingRequest=function(){D.runAfterProcessingRequest=function(){}};var B="";switch(G){case 1:case"text":B=C;break;case 2:case"image":B="<img src='"+C+"' />";break;default:}var E=function(){var H=null;if(window.XMLHttpRequest){H=new XMLHttpRequest()}else{H=new ActiveXObject("Microsoft.XMLHTTP")}return H};this.ProcessTextRequest=function(H,L,I){var J=false;if(!I){I="GET"}if(F==true){return false}F=true;var K=null;K=E();if(K==null){alert("Browser does not support AJAX");return false}else{K.onreadystatechange=function(){if(K.readyState==4||K.readyState=="complete"){if(K.status==200){D.runAfterProcessingRequest(K.responseText);delete K;F=false}else{delete K;F=false}}else{if(B!=""&&J==false){J=true;inLayer.innerHTML+="<BR><BR><center>"+B+"</center>"}}};A(K,H,L,I)}return 1};this.ProcessHtmlRequest=function(M,I,N,J){var K=false;var H=document.getElementById(M);if(!J){J="GET"}if(F==true){return false}F=true;var L=null;L=E();if(L==null){alert("Browser does not support AJAX");return false}else{L.onreadystatechange=function(){if(L.readyState==4||L.readyState=="complete"){if(L.status==200){H.innerHTML=L.responseText;delete L;F=false;D.runAfterProcessingRequest()}else{H.innerHTML="URL not found";delete L;F=false}}else{if(B!=""&&K==false){K=true;H.innerHTML="<center><div id='ajaxBusyImageDiv' style='position: fixed;' align='center'>"+B+"</div></center>"+H.innerHTML;if(document.getElementById&&!document.all){document.getElementById("ajaxBusyImageDiv").style.width=document.getElementById("ajaxBusyImageDiv").parentNode.offsetWidth+"px"}}}};A(L,I,N,J)}return 1};var A=function(H,I,L,J){if(J.toLowerCase()=="post"){H.open(J,I,true);H.setRequestHeader("Content-Type","application/x-www-form-urlencoded");H.send(L)}else{var K=I;if(L){K+="?"+L}H.open(J,K,true);H.send(null)}}};